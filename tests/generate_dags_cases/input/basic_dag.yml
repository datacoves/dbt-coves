description: "Blue / Green run"
schedule_interval: "0 0 1 */12 *"
tags:
  - version_1
default_args:
  start_date: 2023-01-01
catchup: false
custom_callbacks:
  on_success_callback:
    module: callbacks.slack_messages
    callable: inform_success
    args:
      connection_id: DATACOVES_SLACK
      message: Custom YML success message
      color: 0000FF
  on_failure_callback:
    module: callbacks.slack_messages
    callable: inform_failure
    args:
      connection_id: DATACOVES_SLACK
      message: Custom YML error message
      color: 9900FF
nodes:
  transform:
    type: task
    operator: airflow.operators.bash.BashOperator
    bash_command: "$DATACOVES__REPO_PATH/automate/blue_green_run.py -s 'tag:daily_run_airbyte+ tag:daily_run_fivetran+ -t prd'"
    config:
      image: datacoves/airflow-pandas:latest
      resources:
        memory: 8Gi
        cpu: 1000m
  marketing_automation:
    type: task
    operator: airflow.operators.bash.BashOperator
    bash_command: "echo 'send data to marketing tool'"
    dependencies: ["transform"]
  update_catalog:
    type: task
    operator: airflow.operators.bash.BashOperator
    bash_command: "echo 'refresh data catalog'"
    dependencies: ["transform"]
